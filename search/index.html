<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Search · Corridor Ledger</title>
  <link rel="stylesheet" href="/main.css"/>

  <!-- Pagefind UI assets (built by the Action into /pagefind) -->
  <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
  <script defer src="/pagefind/pagefind-ui.js" type="text/javascript"></script>

  <style>
    /* Make Pagefind UI match your theme */
    .pagefind-ui__form,
    .pagefind-ui__search-input,
    .pagefind-ui__results-area,
    .pagefind-ui__drawer { background: var(--paper); color: var(--ink); }
    .pagefind-ui__search-input { border:1px solid var(--border); border-radius:10px; }
    .pagefind-ui__result-excerpt mark,
    .pagefind-ui__search-clear { background: transparent; color: var(--link); }
    html[data-theme="dark"] .pagefind-ui__search-input { border-color:#333; }
  </style>
</head>
<body>
  <!-- reuse your site header -->
  <header class="site-header">
    <div class="brand">
      <button class="icon-btn menu-btn" id="menuToggle" aria-label="Open menu" aria-expanded="false" aria-controls="dropdown">☰</button>
      <a class="logo-link" href="/" aria-label="Corridor Ledger home">
        <img src="/wordmark_header_1200w.png" class="wordmark wordmark-light" alt="">
        <img src="/wordmark_header_dark_1200w.png" class="wordmark wordmark-dark" alt="">
      </a>
      <button class="icon-btn theme-btn" id="themeToggle" aria-label="Toggle dark mode">
        <img src="/sun_grunge_black_transparent.png" class="theme-icon theme-icon-sun" alt="">
        <img src="/moon_grunge_white_transparent.png" class="theme-icon theme-icon-moon" alt="">
      </button>
    </div>
  </header>

  <main class="container" data-pagefind-body>
    <section class="rail">
      <article class="hero hero-center">
        <h1 class="headline">Search</h1>
        <p class="dek">Find issues, articles, and explainers.</p>
        <div id="search"></div>
      </article>
    </section>
  </main>

  <footer class="site-footer">
    <div class="foot-left">
      <a href="/feed.xml">RSS</a> · <a href="/corrections/">Corrections</a> ·
      <a href="mailto:editor@corridorledger.com">Editor</a> · <a href="/tips/">Tips</a>
    </div>
    <div class="foot-right">© 2025 Corridor Ledger</div>
  </footer>

  <script>
    // Init Pagefind UI
    document.addEventListener('DOMContentLoaded', () => {
      const ui = new PagefindUI({
        element: "#search",
        showImages: false,
        translations: { placeholder: "Search Corridor Ledger" }
      });

      // Optional: carry ?q= from the URL into the Pagefind input
      const q = new URLSearchParams(location.search).get('q');
      if (q) {
        // Wait for Pagefind to render its input then inject the query
        setTimeout(() => {
          const input = document.querySelector('.pagefind-ui__search-input');
          if (input) { input.value = q; input.dispatchEvent(new Event('input', { bubbles: true })); }
        }, 0);
      }
    });

    // Your existing theme/menu JS can be included here as on other pages
  </script>
</body>
</html>
